<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>ECharts</title>
</head>

<style>
    body {
        background-color: rgb(250, 214, 214);
        display: flex;
        justify-content: center;
        align-items: center;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
    }
    
    #main,
    canvas {
        position: absolute;
        top: 0 !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
    }
    
    #dialog {
        display: none;
    }
    
    .dialog {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        background: none;
        align-items: center;
        justify-content: center;
        display: flex;
    }
</style>

<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main"></div>
    <div id="dialog">
        <div class="dialog">
            <img src="" id="img" />
        </div>
    </div>


    <!-- ECharts单文件引入 -->
    <script src="./echarts.min.js"></script>


    <script>
        // 基于准备好的dom，初始化echarts图表
        var myChart = echarts.init(document.getElementById('main'));
        //读取本地json文件
        var request = new XMLHttpRequest();
        request.open("get", "jsonFile.json");
        request.send(null);
        request.onload = function() {
            console.log(request.responseText);
            if (request.status == 0) {
                var newData = JSON.parse(request.responseText);
                console.log(jsondata);
            }
        }
        let newData = {
            "name": "纹理=?",
            "children": [
                {
                    "name": "清晰",
                    "children": [
                        {
                            "name": "密度<=0.3815?",
                            "children": [
                                {
                                    "name": "是",
                                    "children": [
                                        {
                                            "name": "坏瓜",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "name": "否",
                                    "children": [
                                        {
                                            "name": "好瓜",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "name": "模糊",
                    "children": [
                        {
                            "name": "坏瓜",
                            "children": []
                        }
                    ]
                },
                {
                    "name": "稍糊",
                    "children": [
                        {
                            "name": "触感=?",
                            "children": [
                                {
                                    "name": "硬滑",
                                    "children": [
                                        {
                                            "name": "坏瓜",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "name": "软粘",
                                    "children": [
                                        {
                                            "name": "好瓜",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
        showEcharts([newData])

        function showEcharts(newData1) {
            console.log(JSON.stringify(newData1))
            var option = {
                title: {
                    text: '',
                    subtext: ''
                },
                tooltip: {
                    show: false,
                    trigger: 'item',
                    formatter: "{b}: {c}"
                },
                toolbox: {
                    show: false
                },
                calculable: false,
                series: [{
                    name: '树图',
                    type: 'tree',
                    roam: true,
                    orient: 'vertical', // vertical horizontal
                    initialTreeDepth: -1,
                    itemStyle: {
                        normal: {
                            label: {
                                show: true,
                                position: 'inside',
                                textStyle: {
                                    color: '#000',
                                    fontSize: 20,
                                    align: 'center',
                                    verticalAlign: 'middle'
                                }
                            },
                            lineStyle: {
                                color: '#999',
                                width: 1,
                                type: 'solid' // 'curve'|'broken'|'solid'|'dotted'|'dashed'
                            },
                            color: '#fff',
                            borderColor: '#fff'
                        }
                    },
                    data: newData1,
                    left: '12%',
                    right: '5%',
                    top: '7%',
                    bottom: '7%',
                }]
            };
            // 为echarts对象加载数据
            myChart.hideLoading(option);
            myChart.setOption(option);
            myChart.on("dblclick", clickFun);
        }
        //关键点！
        function clickFun(param) {
            console.log(param)
                // if (typeof param.seriesIndex == 'undefined') {
                //     return;
                // }
            if (param.type == 'dblclick') {
                var imgurl = param.data.symbol.split('image://')[1];
                document.getElementById('img').src = imgurl
                document.getElementById('dialog').style.display = 'block'

            }
        }
        document.getElementById("dialog").onclick = function() {
            document.getElementById('dialog').style.display = 'none';
        }
    </script>
</body>